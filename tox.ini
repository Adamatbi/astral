[tox]
project = astral
envlist = py27,py35,doc,coverage
toxworkdir = .cache/tox
distdir = .cache/tox/dist
distshare = {homedir}/.cache/tox/

[testenv]
envlogdir = .cache/tox/log/
downloadcache = {homedir}/.cache/pip/
deps =
    pytest

[testenv:py27]
deps=
    {[testenv]deps}
    pytz
envdir = {env:WORKON_HOME}/tox/{[tox]project}_py27/
commands =
    py.test {posargs} -m "not webtest"

[testenv:py35]
deps=
    {[testenv]deps}
    pytz
envdir = {env:WORKON_HOME}/tox/{[tox]project}_py35/
commands =
    py.test {posargs} -m "not webtest"

[testenv:coverage]
#setenv =
#    COVERAGE_FILE = .cache/.coverage
deps =
    {[testenv]deps}
    pytest-cov
envdir = {env:WORKON_HOME}/tox/{[tox]project}_coverage/
commands =
    py.test --cov astral src/test/ -m "not webtest"
    coverage html -d ../../../build/astral/trunk/coverage

[testenv:doc]
passenv = DEV_HOME
changedir = src/doc
envdir = {env:WORKON_HOME}/tox/{[tox]project}_doc/
deps =
    sphinx
commands =
    sphinx-build -W -b html -d {envtmpdir}/doctrees . {envtmpdir}/html
